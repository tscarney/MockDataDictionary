const parseSlots = require('./parseSlots');

module.exports = {
  userIntentSlotsCanBeFufilled(UserIntents, BusinessIntent) {
    UserIntents.forEach((i) => {
      i.utterances.forEach((u) => {
        this.findBusinessSlots(u, BusinessIntent);
      });
    });
  },
  findBusinessSlots(utterance, BusinessIntent) {
    const slots = parseSlots(utterance);
    return slots.map((s) => {
      const businessSlots = BusinessIntent && BusinessIntent.businessSlots;
      const found = businessSlots && businessSlots.find(bS => bS.name === s.businessSlot);
      if (!found) {
        throw new Error(`Could not find slot ${s.businessSlot} as provided in utterance ${utterance}`);
      }
      return found;
    });
  }
};
